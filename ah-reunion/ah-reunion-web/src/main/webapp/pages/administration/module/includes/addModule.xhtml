<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:cc = "http://java.sun.com/jsf/composite/component"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:gt = "http://airalgerie.dz/facelets/grh"
                xmlns:ct = "http://airalgerie.dz/facelets"
                xmlns:o="http://omnifaces.org/ui">

    <h:panelGroup layout="block" id="dialogWrapper">
        <h:panelGroup id="alertWrapper" layout="block" styleClass="row">
            <cc:alert alert="#{moduleBean.alertBean.alerts}" />
        </h:panelGroup>
        <b:messages />

        <b:row id="new-module-container">
            <b:column col-xs="12" >
                <div class="col-sm-6 col-md-4">
                    <ct:input id="new-module-code" label="Code" placeholder="Code..."
                              value="#{moduleBean.module.code}" required="true"
                              />
                </div>
                <div class="col-sm-6 col-md-8">
                    <ct:input id="new-module-libelle" label="Libellé" placeholder="Libellé..."
                              value="#{moduleBean.module.libelle}" required="true"
                              />
                </div>
                <div class="col-sm-12">
                    <ct:input id="new-module-descr" label="Description" placeholder="Description..."
                              value="#{moduleBean.module.descr}" required="true"
                              />
                </div>
                <div class="col-sm-6">
                    <ct:input type="autocomplete" id="new-module-module-parent" label="Module parent" 
                              value="#{moduleBean.module.refModuleParent}" placeholder="Module parent..."
                              completeMethod="#{refHelpersBean.autoCompleteModules}" immediate="true"
                              var="module" itemValue="#{module}" itemLabel="#{module.libelle}">
                        <p:ajax event="itemSelect" process="@this" update="" onstart="loading()" oncomplete="loadingHide()" />
                        <o:converter converterId="omnifaces.ListConverter" list="#{refHelpersBean.modulesList}" />
                    </ct:input>
                </div>

                <div class="col-sm-6">
                    <ct:input id="new-module-domaine" type="menuConverter" label="Domaine" 
                              value="#{moduleBean.module.refDomaine}" required="true">
                        <f:selectItem itemLabel="Sélectionnez un domaine" itemValue="" noSelectionOption="true" />
                        <f:selectItems value="#{refHelpersBean.domainesList}" var="domaine" itemLabel="#{domaine.code}" itemValue="#{domaine}" />
                    </ct:input>
                </div>

                <div class="col-sm-6 col-md-6">
                    <ct:input id="new-module-icon" label="Icone" placeholder="Icone..."
                              value="#{moduleBean.module.icon}"
                              />
                </div>
                <b:column col-md="3" col-sm="6">
                    <ct:input type="number" id="new-module-rang" label="Rang" placeholder="Rang..."
                              value="#{moduleBean.module.rang}" min='1'
                              required="true" decimalPlaces="0" />
                </b:column>
                <div class="col-sm-6 col-md-3">
                    <b:switch value="#{moduleBean.module.statut}" label="Statut" 
                              offText="Non activé" offColor="danger" 
                              onText="Activé" onColor="success"  />
                </div>
            </b:column>
        </b:row>
    </h:panelGroup>

    <p:commandLink styleClass="addModuleBtn hidden" onclick="loading()"
                   id="devButton" update="dialogWrapper :contentForm" process="@form"
                   oncomplete=" if (args &amp;&amp; !args.validationFailed) {PF('addModule').hide();} loadingHide();" 
                   actionListener="#{moduleBean.saveModule()}">
    </p:commandLink>
</ui:composition>